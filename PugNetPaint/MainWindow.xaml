<Window x:Class="PugNetPaint.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PugNetPaint"
        mc:Ignorable="d"
        Title="Pug.net Paint" Height="600" Width="900"
        KeyDown="Window_KeyDown"
        Icon="icon.ico"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen">
    
    <Grid Background="#1e1e1e">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Top Toolbar with Glassmorphism-ish feel -->
        <Border Background="#2d2d2d" Padding="15" BorderBrush="#404040" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                
                <!-- Colors Group -->
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="PALETTE" Foreground="#aaaaaa" FontSize="10" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <Button Background="Blue" Width="30" Height="30" Click="Color_Click" Tag="Blue" Margin="2" BorderThickness="0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="15" BorderBrush="White" BorderThickness="1" Cursor="Hand"/>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button Background="Green" Width="30" Height="30" Click="Color_Click" Tag="Green" Margin="2" BorderThickness="0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="15" BorderBrush="White" BorderThickness="1" Cursor="Hand"/>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button Background="Red" Width="30" Height="30" Click="Color_Click" Tag="Red" Margin="2" BorderThickness="0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="15" BorderBrush="White" BorderThickness="1" Cursor="Hand"/>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button Background="Orange" Width="30" Height="30" Click="Color_Click" Tag="Orange" Margin="2" BorderThickness="0">
                         <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="15" BorderBrush="White" BorderThickness="1" Cursor="Hand"/>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>

                <Separator Width="30" Background="Transparent"/>

                <!-- Brush Size Group -->
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="BRUSH" Foreground="#aaaaaa" FontSize="10" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <Slider x:Name="SizeSlider" Minimum="1" Maximum="10" Value="2" Width="120" VerticalAlignment="Center" ValueChanged="Size_Changed" IsSnapToTickEnabled="True" TickFrequency="1"/>
                    <TextBlock Text="{Binding ElementName=SizeSlider, Path=Value}" Foreground="White" FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0" Width="20"/>
                </StackPanel>

                <Separator Width="30" Background="Transparent"/>

                <!-- Tools Group -->
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <ToggleButton Content="SNAP" x:Name="SnapToggle" Padding="15,5" Margin="2" Background="#444" Foreground="White" FontWeight="Bold" BorderThickness="0">
                         <ToggleButton.Resources>
                           <Style TargetType="Border">
                               <Setter Property="CornerRadius" Value="5"/>
                           </Style>
                       </ToggleButton.Resources>
                    </ToggleButton>
                    
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="5,0,10,0">
                         <TextBlock Text="MAGNET" Foreground="#aaaaaa" FontSize="10" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,5,0"/>
                         <Slider x:Name="SnapSlider" Minimum="10" Maximum="200" Value="50" Width="80" VerticalAlignment="Center" ToolTip="Adjust Snap Strength"/>
                    </StackPanel>
                    <Button Content="UNDO" Click="Undo_Click" Padding="15,5" Margin="2" Background="#444" Foreground="White" FontWeight="Bold" BorderThickness="0">
                       <Button.Resources>
                           <Style TargetType="Border">
                               <Setter Property="CornerRadius" Value="5"/>
                           </Style>
                       </Button.Resources>
                    </Button>
                    <Button Content="ERASER" Click="Eraser_Click" Padding="15,5" Margin="2" Background="#444" Foreground="White" FontWeight="Bold" BorderThickness="0"/>
                    <Button Content="CLEAR" Click="Clear_Click" Padding="15,5" Margin="2" Background="#444" Foreground="White" FontWeight="Bold" BorderThickness="0"/>
                    
                    <Button Content="SAVE" x:Name="SaveBtn" Click="SaveBtn_Click" Padding="15,5" Margin="2" Background="#444" Foreground="White" FontWeight="Bold" BorderThickness="0">
                        <Button.ContextMenu>
                            <ContextMenu x:Name="SaveContextMenu" Opened="SaveContextMenu_Opened">
                                <MenuItem Header="Save Project (.isf) - Editable" Click="SaveProject_Click"/>
                                <Separator/>
                                <MenuItem Header="Export as PNG" Click="ExportPng_Click"/>
                                <MenuItem Header="Export as JPG" Click="ExportJpg_Click"/>
                                <Separator x:Name="ExperimentalSeparator" Visibility="Collapsed"/>
                                <MenuItem x:Name="ExperimentalPngMenuItem" Header="🧪 Export PNG with History (BETA)" Click="ExperimentalExportPng_Click" Visibility="Collapsed"/>
                                <MenuItem x:Name="ExperimentalJpgMenuItem" Header="🧪 Export JPG with History (BETA)" Click="ExperimentalExportJpg_Click" Visibility="Collapsed"/>
                            </ContextMenu>
                        </Button.ContextMenu>
                    </Button>

                    <Button Content="OPEN" Click="Open_Click" Padding="15,5" Margin="2" Background="#444" Foreground="White" FontWeight="Bold" BorderThickness="0"/>
                    <Button Content="PRINT" Click="Print_Click" Padding="15,5" Margin="2" Background="#444" Foreground="White" FontWeight="Bold" BorderThickness="0"/>
                    <Separator Width="15" Background="Transparent"/>
                    <Button Content="⚙️" x:Name="SettingsBtn" Click="Settings_Click" Padding="10,5" Margin="2" Background="#555" Foreground="White" FontSize="16" BorderThickness="0" ToolTip="Settings">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="5"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                </StackPanel>

            </StackPanel>
        </Border>

        <!-- Canvas Area -->
        <Border Grid.Row="1" Margin="20" Background="#ffffff" CornerRadius="10">
            <Border.Effect>
                <DropShadowEffect Color="Black" Direction="320" ShadowDepth="5" Opacity="0.5" BlurRadius="10"/>
            </Border.Effect>
             <InkCanvas x:Name="MyCanvas" Background="Transparent"/>
        </Border>
    </Grid>
</Window>
